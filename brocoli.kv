#:kivy 1.11.1

<MainWidget>:
    BoxLayout:
        size: root.size
        pos: root.pos

        Brocoli:
            id: brocoli
            size_hint: (0.7, 1)
            image: image

            # Thanks automatic binding
            steps: int(2 ** steps_slider.value)
            kind: kind_slider.value
            pixel_size: pixel_slider.value
            loop_gradient: loop_checkbox.active
            gradient_speed: gradient_speed_slider.value
            gradient_offset: gradient_offset_slider.value
            black_inside: black_inside_checkbox.active
            steps_power: steps_power_slider.value
            normalize_quantiles: quantiles_checkbox.active

            Image:
                id: image
                pos: self.parent.pos
                size: self.parent.size
                source: "frac.png"
                allow_stretch: True
                mipmap: True

        BoxLayout:
            size_hint: (0.3, 1)
#            cols: 2
            orientation: "vertical"

            Label:
                text: "Brocoli"
                font_size: 50
            Label:
                text: str(brocoli.camera.center)
                size_hint_y: None
                size: self.texture_size


            LabeledSlider:
                text: "Pixel size"
                id: pixel_slider
                min: 1
                max: 10
                step: 1
                value: 1

            LabeledSlider:
                text: "Steps"
                id: steps_slider
                min: 5
                max: 14
                step: 1

            LabeledSlider:
                text: "Coloration kind"
                id: kind_slider
                min: 0
                max: 3
                value: 1
                step: 1

            BoxLayout:
                Label:
                    text: "Loop gradient ?"
                CheckBox:
                    id: loop_checkbox
                    active: True

            BoxLayout:
                Label:
                    text: "Normalize quantiles ?"
                CheckBox:
                    id: quantiles_checkbox
                    active: True

            LabeledSlider:
                text: "Steps power"
                id: steps_power_slider
                min: 0.1
                max: 4
                value: 1

            LabeledSlider:
                text: "Gradient speed"
                id: gradient_speed_slider
                min: 1
                max:Â 10

            LabeledSlider:
                text: "Gradient offset"
                id: gradient_offset_slider
                min: 0
                max: 1

            BoxLayout:
                Label:
                    text: "Black inside ?"
                CheckBox:
                    id: black_inside_checkbox

            BoxLayout:
                Button:
                    text: "Random position"
                    on_release: brocoli.set_random_position()

                Button:
                    id: save_buttom
                    text: "Save 4K image"
                    on_release: brocoli.save_4k()


<LabeledSlider>:
    value: slider.value
    Label:
        size_hint_x: 0.4
        text: self.parent.text + " ({}) :".format(round(slider.value, 2))
    Slider:
        id: slider
        size_hint_x: 0.6
        min: self.parent.min
        max: self.parent.max
        value: self.parent.value
        step: self.parent.step
